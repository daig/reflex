<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><a name="line-2"></a><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><a name="line-3"></a><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><a name="line-4"></a><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><a name="line-5"></a><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><a name="line-6"></a><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><a name="line-7"></a><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><a name="line-8"></a><span class="hs-pragma">{-# LANGUAGE NoMonomorphismRestriction #-}</span><span>
</span><a name="line-9"></a><span class="hs-pragma">{-# LANGUAGE PolyKinds #-}</span><span>
</span><a name="line-10"></a><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><a name="line-11"></a><span class="hs-pragma">{-# LANGUAGE RecursiveDo #-}</span><span>
</span><a name="line-12"></a><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><a name="line-13"></a><span class="hs-pragma">{-# LANGUAGE StandaloneDeriving #-}</span><span>
</span><a name="line-14"></a><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><a name="line-15"></a><span class="hs-pragma">{-# LANGUAGE TypeOperators #-}</span><span>
</span><a name="line-16"></a><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><a name="line-17"></a><span class="hs-cpp">#ifdef USE_REFLEX_OPTIMIZER</span><span>
</span><a name="line-18"></a><span class="hs-pragma">{-# OPTIONS_GHC -fplugin=Reflex.Optimizer #-}</span><span>
</span><a name="line-19"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-20"></a><span class="hs-comment">-- | This module contains various functions for working with 'Dynamic' values.</span><span>
</span><a name="line-21"></a><span class="hs-comment">-- 'Dynamic' and its primitives have been moved to the 'Reflex' class.</span><span>
</span><a name="line-22"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Reflex</span><span class="hs-operator">.</span><span class="hs-identifier">Dynamic</span><span>
</span><a name="line-23"></a><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-comment">-- * Basics</span><span>
</span><a name="line-24"></a><span>    </span><a href="Reflex.Class.html#Dynamic"><span class="hs-identifier hs-type">Dynamic</span></a><span> </span><span class="hs-comment">-- Abstract so we can preserve the law that the current value is always equal to the most recent update</span><span>
</span><a name="line-25"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Reflex.Class.html#current"><span class="hs-identifier hs-var">current</span></a><span>
</span><a name="line-26"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Reflex.Class.html#updated"><span class="hs-identifier hs-var">updated</span></a><span>
</span><a name="line-27"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Reflex.Class.html#holdDyn"><span class="hs-identifier hs-var">holdDyn</span></a><span>
</span><a name="line-28"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Reflex.Class.html#constDyn"><span class="hs-identifier hs-var">constDyn</span></a><span>
</span><a name="line-29"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Reflex.Dynamic.html#count"><span class="hs-identifier hs-var">count</span></a><span>
</span><a name="line-30"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Reflex.Dynamic.html#toggle"><span class="hs-identifier hs-var">toggle</span></a><span>
</span><a name="line-31"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Reflex.Dynamic.html#switchPromptlyDyn"><span class="hs-identifier hs-var">switchPromptlyDyn</span></a><span>
</span><a name="line-32"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Reflex.Dynamic.html#tagPromptlyDyn"><span class="hs-identifier hs-var">tagPromptlyDyn</span></a><span>
</span><a name="line-33"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Reflex.Dynamic.html#attachPromptlyDyn"><span class="hs-identifier hs-var">attachPromptlyDyn</span></a><span>
</span><a name="line-34"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Reflex.Dynamic.html#attachPromptlyDynWith"><span class="hs-identifier hs-var">attachPromptlyDynWith</span></a><span>
</span><a name="line-35"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Reflex.Dynamic.html#attachPromptlyDynWithMaybe"><span class="hs-identifier hs-var">attachPromptlyDynWithMaybe</span></a><span>
</span><a name="line-36"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Reflex.Dynamic.html#maybeDyn"><span class="hs-identifier hs-var">maybeDyn</span></a><span>
</span><a name="line-37"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Reflex.Dynamic.html#scanDyn"><span class="hs-identifier hs-var">scanDyn</span></a><span>
</span><a name="line-38"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Reflex.Dynamic.html#scanDynMaybe"><span class="hs-identifier hs-var">scanDynMaybe</span></a><span>
</span><a name="line-39"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Reflex.Dynamic.html#holdUniqDyn"><span class="hs-identifier hs-var">holdUniqDyn</span></a><span>
</span><a name="line-40"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Reflex.Dynamic.html#holdUniqDynBy"><span class="hs-identifier hs-var">holdUniqDynBy</span></a><span>
</span><a name="line-41"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Reflex.Dynamic.html#improvingMaybe"><span class="hs-identifier hs-var">improvingMaybe</span></a><span>
</span><a name="line-42"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Reflex.Dynamic.html#foldDyn"><span class="hs-identifier hs-var">foldDyn</span></a><span>
</span><a name="line-43"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Reflex.Dynamic.html#foldDynM"><span class="hs-identifier hs-var">foldDynM</span></a><span>
</span><a name="line-44"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Reflex.Dynamic.html#foldDynMaybe"><span class="hs-identifier hs-var">foldDynMaybe</span></a><span>
</span><a name="line-45"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Reflex.Dynamic.html#foldDynMaybeM"><span class="hs-identifier hs-var">foldDynMaybeM</span></a><span>
</span><a name="line-46"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Reflex.Dynamic.html#joinDynThroughMap"><span class="hs-identifier hs-var">joinDynThroughMap</span></a><span>
</span><a name="line-47"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Reflex.Dynamic.html#traceDyn"><span class="hs-identifier hs-var">traceDyn</span></a><span>
</span><a name="line-48"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Reflex.Dynamic.html#traceDynWith"><span class="hs-identifier hs-var">traceDynWith</span></a><span>
</span><a name="line-49"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Reflex.Dynamic.html#splitDynPure"><span class="hs-identifier hs-var">splitDynPure</span></a><span>
</span><a name="line-50"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Reflex.Dynamic.html#distributeMapOverDynPure"><span class="hs-identifier hs-var">distributeMapOverDynPure</span></a><span>
</span><a name="line-51"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Reflex.Class.html#distributeDMapOverDynPure"><span class="hs-identifier hs-var">distributeDMapOverDynPure</span></a><span>
</span><a name="line-52"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Reflex.Dynamic.html#distributeListOverDynPure"><span class="hs-identifier hs-var">distributeListOverDynPure</span></a><span>
</span><a name="line-53"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Reflex.Dynamic.html#Demux"><span class="hs-identifier hs-type">Demux</span></a><span>
</span><a name="line-54"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Reflex.Dynamic.html#demux"><span class="hs-identifier hs-var">demux</span></a><span>
</span><a name="line-55"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Reflex.Dynamic.html#demuxed"><span class="hs-identifier hs-var">demuxed</span></a><span>
</span><a name="line-56"></a><span>    </span><span class="hs-comment">-- Things that probably aren't very useful:</span><span>
</span><a name="line-57"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Reflex.Dynamic.html#HList"><span class="hs-identifier hs-type">HList</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-58"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Reflex.Dynamic.html#FHList"><span class="hs-identifier hs-type">FHList</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-59"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Reflex.Dynamic.html#collectDynPure"><span class="hs-identifier hs-var">collectDynPure</span></a><span>
</span><a name="line-60"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Reflex.Dynamic.html#RebuildSortedHList"><span class="hs-identifier hs-type">RebuildSortedHList</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-61"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Reflex.Dynamic.html#IsHList"><span class="hs-identifier hs-type">IsHList</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-62"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Reflex.Dynamic.html#AllAreFunctors"><span class="hs-identifier hs-type">AllAreFunctors</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-63"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Reflex.Dynamic.html#HListPtr"><span class="hs-identifier hs-type">HListPtr</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-64"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Reflex.Dynamic.html#distributeFHListOverDynPure"><span class="hs-identifier hs-var">distributeFHListOverDynPure</span></a><span>
</span><a name="line-65"></a><span>    </span><span class="hs-comment">-- Unsafe</span><span>
</span><a name="line-66"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Reflex.Class.html#unsafeDynamic"><span class="hs-identifier hs-var">unsafeDynamic</span></a><span>
</span><a name="line-67"></a><span>    </span><span class="hs-comment">-- * Deprecated functions</span><span>
</span><a name="line-68"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Reflex.Dynamic.html#apDyn"><span class="hs-identifier hs-var">apDyn</span></a><span>
</span><a name="line-69"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Reflex.Dynamic.html#attachDyn"><span class="hs-identifier hs-var">attachDyn</span></a><span>
</span><a name="line-70"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Reflex.Dynamic.html#attachDynWith"><span class="hs-identifier hs-var">attachDynWith</span></a><span>
</span><a name="line-71"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Reflex.Dynamic.html#attachDynWithMaybe"><span class="hs-identifier hs-var">attachDynWithMaybe</span></a><span>
</span><a name="line-72"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Reflex.Dynamic.html#collectDyn"><span class="hs-identifier hs-var">collectDyn</span></a><span>
</span><a name="line-73"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Reflex.Dynamic.html#combineDyn"><span class="hs-identifier hs-var">combineDyn</span></a><span>
</span><a name="line-74"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Reflex.Dynamic.html#distributeDMapOverDyn"><span class="hs-identifier hs-var">distributeDMapOverDyn</span></a><span>
</span><a name="line-75"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Reflex.Dynamic.html#distributeFHListOverDyn"><span class="hs-identifier hs-var">distributeFHListOverDyn</span></a><span>
</span><a name="line-76"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Reflex.Dynamic.html#forDyn"><span class="hs-identifier hs-var">forDyn</span></a><span>
</span><a name="line-77"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Reflex.Dynamic.html#forDynM"><span class="hs-identifier hs-var">forDynM</span></a><span>
</span><a name="line-78"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Reflex.Dynamic.html#getDemuxed"><span class="hs-identifier hs-var">getDemuxed</span></a><span>
</span><a name="line-79"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Reflex.Dynamic.html#joinDyn"><span class="hs-identifier hs-var">joinDyn</span></a><span>
</span><a name="line-80"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Reflex.Dynamic.html#mapDyn"><span class="hs-identifier hs-var">mapDyn</span></a><span>
</span><a name="line-81"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Reflex.Dynamic.html#mapDynM"><span class="hs-identifier hs-var">mapDynM</span></a><span>
</span><a name="line-82"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Reflex.Dynamic.html#mconcatDyn"><span class="hs-identifier hs-var">mconcatDyn</span></a><span>
</span><a name="line-83"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Reflex.Dynamic.html#nubDyn"><span class="hs-identifier hs-var">nubDyn</span></a><span>
</span><a name="line-84"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Reflex.Dynamic.html#splitDyn"><span class="hs-identifier hs-var">splitDyn</span></a><span>
</span><a name="line-85"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Reflex.Dynamic.html#tagDyn"><span class="hs-identifier hs-var">tagDyn</span></a><span>
</span><a name="line-86"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Reflex.Dynamic.html#uniqDyn"><span class="hs-identifier hs-var">uniqDyn</span></a><span>
</span><a name="line-87"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Reflex.Dynamic.html#uniqDynBy"><span class="hs-identifier hs-var">uniqDynBy</span></a><span>
</span><a name="line-88"></a><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-89"></a><span>
</span><a name="line-90"></a><span class="hs-keyword">import</span><span> </span><a href="Data.Functor.Misc.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Functor</span><span class="hs-operator">.</span><span class="hs-identifier">Misc</span></a><span>
</span><a name="line-91"></a><span class="hs-keyword">import</span><span> </span><a href="Reflex.Class.html"><span class="hs-identifier">Reflex</span><span class="hs-operator">.</span><span class="hs-identifier">Class</span></a><span>
</span><a name="line-92"></a><span>
</span><a name="line-93"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Applicative</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;*&gt;</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-94"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span>
</span><a name="line-95"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">Fix</span><span>
</span><a name="line-96"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">Identity</span><span>
</span><a name="line-97"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Align</span><span>
</span><a name="line-98"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Dependent</span><span class="hs-operator">.</span><span class="hs-identifier">Map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">DMap</span><span class="hs-special">)</span><span>
</span><a name="line-99"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Dependent</span><span class="hs-operator">.</span><span class="hs-identifier">Map</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">DMap</span><span>
</span><a name="line-100"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Dependent</span><span class="hs-operator">.</span><span class="hs-identifier">Sum</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">DSum</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-101"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">GADT</span><span class="hs-operator">.</span><span class="hs-identifier">Compare</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-type">:~:</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">GCompare</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">GEq</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">GOrdering</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-102"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Map</span><span class="hs-special">)</span><span>
</span><a name="line-103"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Maybe</span><span>
</span><a name="line-104"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Monoid</span><span>
</span><a name="line-105"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">These</span><span>
</span><a name="line-106"></a><span>
</span><a name="line-107"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Debug</span><span class="hs-operator">.</span><span class="hs-identifier">Trace</span><span>
</span><a name="line-108"></a><span>
</span><a name="line-109"></a><span class="hs-comment">-- | Create a new 'Dynamic' that only signals changes if the values actually</span><span>
</span><a name="line-110"></a><span class="hs-comment">-- changed.</span><span>
</span><a name="line-111"></a><span class="hs-identifier">holdUniqDyn</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Reflex.Class.html#Reflex"><span class="hs-identifier hs-type">Reflex</span></a><span> </span><a href="#local-6989586621679323959"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">,</span><span> </span><a href="Reflex.Class.html#MonadHold"><span class="hs-identifier hs-type">MonadHold</span></a><span> </span><a href="#local-6989586621679323959"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679323960"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">MonadFix</span><span> </span><a href="#local-6989586621679323960"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679323961"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Reflex.Class.html#Dynamic"><span class="hs-identifier hs-type">Dynamic</span></a><span> </span><a href="#local-6989586621679323959"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679323961"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679323960"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="Reflex.Class.html#Dynamic"><span class="hs-identifier hs-type">Dynamic</span></a><span> </span><a href="#local-6989586621679323959"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679323961"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-112"></a><a name="holdUniqDyn"><a href="Reflex.Dynamic.html#holdUniqDyn"><span class="hs-identifier">holdUniqDyn</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Reflex.Dynamic.html#holdUniqDynBy"><span class="hs-identifier hs-var">holdUniqDynBy</span></a><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">==</span><span class="hs-special">)</span><span>
</span><a name="line-113"></a><span>
</span><a name="line-114"></a><span class="hs-comment">-- | Create a new 'Dynamic' that changes only when the underlying 'Dynamic'</span><span>
</span><a name="line-115"></a><span class="hs-comment">-- changes and the given function returns 'False' when given both the old and</span><span>
</span><a name="line-116"></a><span class="hs-comment">-- the new values.</span><span>
</span><a name="line-117"></a><span class="hs-identifier">holdUniqDynBy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Reflex.Class.html#Reflex"><span class="hs-identifier hs-type">Reflex</span></a><span> </span><a href="#local-6989586621679323956"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">,</span><span> </span><a href="Reflex.Class.html#MonadHold"><span class="hs-identifier hs-type">MonadHold</span></a><span> </span><a href="#local-6989586621679323956"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679323957"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">MonadFix</span><span> </span><a href="#local-6989586621679323957"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679323958"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679323958"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Reflex.Class.html#Dynamic"><span class="hs-identifier hs-type">Dynamic</span></a><span> </span><a href="#local-6989586621679323956"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679323958"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679323957"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="Reflex.Class.html#Dynamic"><span class="hs-identifier hs-type">Dynamic</span></a><span> </span><a href="#local-6989586621679323956"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679323958"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-118"></a><a name="holdUniqDynBy"><a href="Reflex.Dynamic.html#holdUniqDynBy"><span class="hs-identifier">holdUniqDynBy</span></a></a><span> </span><a name="local-6989586621679323962"><a href="#local-6989586621679323962"><span class="hs-identifier">eq</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Reflex.Dynamic.html#scanDynMaybe"><span class="hs-identifier hs-var">scanDynMaybe</span></a><span> </span><span class="hs-identifier hs-var">id</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679323963"><a href="#local-6989586621679323963"><span class="hs-identifier">new</span></a></a><span> </span><a name="local-6989586621679323964"><a href="#local-6989586621679323964"><span class="hs-identifier">old</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679323963"><span class="hs-identifier hs-var">new</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679323962"><span class="hs-identifier hs-var">eq</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679323964"><span class="hs-identifier hs-var">old</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679323963"><span class="hs-identifier hs-var">new</span></a><span class="hs-special">)</span><span>
</span><a name="line-119"></a><span>
</span><a name="line-120"></a><span class="hs-comment">-- | Dynamic Maybe that can only update from Nothing to Just or Just to Just (i.e., cannot revert to Nothing)</span><span>
</span><a name="line-121"></a><span class="hs-identifier">improvingMaybe</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Reflex.Class.html#Reflex"><span class="hs-identifier hs-type">Reflex</span></a><span> </span><a href="#local-6989586621679323953"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">,</span><span> </span><a href="Reflex.Class.html#MonadHold"><span class="hs-identifier hs-type">MonadHold</span></a><span> </span><a href="#local-6989586621679323953"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679323954"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">MonadFix</span><span> </span><a href="#local-6989586621679323954"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Reflex.Class.html#Dynamic"><span class="hs-identifier hs-type">Dynamic</span></a><span> </span><a href="#local-6989586621679323953"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679323955"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679323954"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="Reflex.Class.html#Dynamic"><span class="hs-identifier hs-type">Dynamic</span></a><span> </span><a href="#local-6989586621679323953"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679323955"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-122"></a><a name="improvingMaybe"><a href="Reflex.Dynamic.html#improvingMaybe"><span class="hs-identifier">improvingMaybe</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Reflex.Dynamic.html#scanDynMaybe"><span class="hs-identifier hs-var">scanDynMaybe</span></a><span> </span><span class="hs-identifier hs-var">id</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679323965"><a href="#local-6989586621679323965"><span class="hs-identifier">new</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">isJust</span><span> </span><a href="#local-6989586621679323965"><span class="hs-identifier hs-var">new</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679323965"><span class="hs-identifier hs-var">new</span></a><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">)</span><span>
</span><a name="line-123"></a><span>
</span><a name="line-124"></a><span class="hs-comment">-- | Create a 'Dynamic' that accumulates values from another 'Dynamic'.  This</span><span>
</span><a name="line-125"></a><span class="hs-comment">-- function does not force its input 'Dynamic' until the output 'Dynamic' is</span><span>
</span><a name="line-126"></a><span class="hs-comment">-- forced.</span><span>
</span><a name="line-127"></a><span class="hs-identifier">scanDyn</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Reflex.Class.html#Reflex"><span class="hs-identifier hs-type">Reflex</span></a><span> </span><a href="#local-6989586621679323949"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">,</span><span> </span><a href="Reflex.Class.html#MonadHold"><span class="hs-identifier hs-type">MonadHold</span></a><span> </span><a href="#local-6989586621679323949"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679323950"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">MonadFix</span><span> </span><a href="#local-6989586621679323950"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679323951"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679323952"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679323951"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679323952"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679323952"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Reflex.Class.html#Dynamic"><span class="hs-identifier hs-type">Dynamic</span></a><span> </span><a href="#local-6989586621679323949"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679323951"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679323950"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="Reflex.Class.html#Dynamic"><span class="hs-identifier hs-type">Dynamic</span></a><span> </span><a href="#local-6989586621679323949"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679323952"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-128"></a><a name="scanDyn"><a href="Reflex.Dynamic.html#scanDyn"><span class="hs-identifier">scanDyn</span></a></a><span> </span><a name="local-6989586621679323966"><a href="#local-6989586621679323966"><span class="hs-identifier">z</span></a></a><span> </span><a name="local-6989586621679323967"><a href="#local-6989586621679323967"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Reflex.Dynamic.html#scanDynMaybe"><span class="hs-identifier hs-var">scanDynMaybe</span></a><span> </span><a href="#local-6989586621679323966"><span class="hs-identifier hs-var">z</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679323968"><a href="#local-6989586621679323968"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679323969"><a href="#local-6989586621679323969"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679323967"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679323968"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679323969"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-129"></a><span>
</span><a name="line-130"></a><span class="hs-comment">-- | Like 'scanDyn', but the the accumulator function may decline to update the</span><span>
</span><a name="line-131"></a><span class="hs-comment">-- result 'Dynamic''s value.</span><span>
</span><a name="line-132"></a><span class="hs-identifier">scanDynMaybe</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Reflex.Class.html#Reflex"><span class="hs-identifier hs-type">Reflex</span></a><span> </span><a href="#local-6989586621679323945"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">,</span><span> </span><a href="Reflex.Class.html#MonadHold"><span class="hs-identifier hs-type">MonadHold</span></a><span> </span><a href="#local-6989586621679323945"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679323946"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">MonadFix</span><span> </span><a href="#local-6989586621679323946"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679323947"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679323948"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679323947"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679323948"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679323948"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Reflex.Class.html#Dynamic"><span class="hs-identifier hs-type">Dynamic</span></a><span> </span><a href="#local-6989586621679323945"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679323947"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679323946"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="Reflex.Class.html#Dynamic"><span class="hs-identifier hs-type">Dynamic</span></a><span> </span><a href="#local-6989586621679323945"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679323948"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-133"></a><a name="scanDynMaybe"><a href="Reflex.Dynamic.html#scanDynMaybe"><span class="hs-identifier">scanDynMaybe</span></a></a><span> </span><a name="local-6989586621679323970"><a href="#local-6989586621679323970"><span class="hs-identifier">z</span></a></a><span> </span><a name="local-6989586621679323971"><a href="#local-6989586621679323971"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679323972"><a href="#local-6989586621679323972"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-134"></a><span>  </span><span class="hs-identifier">rec</span><span> </span><a name="local-6989586621679323973"><a href="#local-6989586621679323973"><span class="hs-identifier">d'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Reflex.Class.html#buildDynamic"><span class="hs-identifier hs-var">buildDynamic</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679323970"><span class="hs-identifier hs-var">z</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Reflex.Class.html#sample"><span class="hs-identifier hs-var">sample</span></a><span> </span><span class="hs-special">(</span><a href="Reflex.Class.html#current"><span class="hs-identifier hs-var">current</span></a><span> </span><a href="#local-6989586621679323972"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">flip</span><span> </span><a href="Reflex.Class.html#push"><span class="hs-identifier hs-var">push</span></a><span> </span><span class="hs-special">(</span><a href="Reflex.Class.html#updated"><span class="hs-identifier hs-var">updated</span></a><span> </span><a href="#local-6989586621679323972"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679323974"><a href="#local-6989586621679323974"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-135"></a><span>        </span><a name="local-6989586621679323975"><a href="#local-6989586621679323975"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Reflex.Class.html#sample"><span class="hs-identifier hs-var">sample</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Reflex.Class.html#current"><span class="hs-identifier hs-var">current</span></a><span> </span><a href="#local-6989586621679323973"><span class="hs-identifier hs-var">d'</span></a><span>
</span><a name="line-136"></a><span>        </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679323971"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679323974"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679323975"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-137"></a><span>  </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679323973"><span class="hs-identifier hs-var">d'</span></a><span>
</span><a name="line-138"></a><span>
</span><a name="line-139"></a><span class="hs-comment">-- | Create a 'Dynamic' using the initial value and change it each time the</span><span>
</span><a name="line-140"></a><span class="hs-comment">-- 'Event' occurs using a folding function on the previous value and the value</span><span>
</span><a name="line-141"></a><span class="hs-comment">-- of the 'Event'.</span><span>
</span><a name="line-142"></a><span class="hs-identifier">foldDyn</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Reflex.Class.html#Reflex"><span class="hs-identifier hs-type">Reflex</span></a><span> </span><a href="#local-6989586621679323941"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">,</span><span> </span><a href="Reflex.Class.html#MonadHold"><span class="hs-identifier hs-type">MonadHold</span></a><span> </span><a href="#local-6989586621679323941"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679323942"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">MonadFix</span><span> </span><a href="#local-6989586621679323942"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679323943"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679323944"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679323944"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679323944"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Reflex.Class.html#Event"><span class="hs-identifier hs-type">Event</span></a><span> </span><a href="#local-6989586621679323941"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679323943"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679323942"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="Reflex.Class.html#Dynamic"><span class="hs-identifier hs-type">Dynamic</span></a><span> </span><a href="#local-6989586621679323941"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679323944"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-143"></a><a name="foldDyn"><a href="Reflex.Dynamic.html#foldDyn"><span class="hs-identifier">foldDyn</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Reflex.Class.html#accum"><span class="hs-identifier hs-var">accum</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">flip</span><span>
</span><a name="line-144"></a><span>
</span><a name="line-145"></a><span class="hs-comment">-- | Like 'foldDyn', but the combining function is a 'PushM' action, so it</span><span>
</span><a name="line-146"></a><span class="hs-comment">-- can 'sample' existing 'Behaviors' and 'hold' new ones.</span><span>
</span><a name="line-147"></a><span class="hs-identifier">foldDynM</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Reflex.Class.html#Reflex"><span class="hs-identifier hs-type">Reflex</span></a><span> </span><a href="#local-6989586621679323937"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">,</span><span> </span><a href="Reflex.Class.html#MonadHold"><span class="hs-identifier hs-type">MonadHold</span></a><span> </span><a href="#local-6989586621679323937"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679323938"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">MonadFix</span><span> </span><a href="#local-6989586621679323938"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679323939"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679323940"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Reflex.Class.html#PushM"><span class="hs-identifier hs-type">PushM</span></a><span> </span><a href="#local-6989586621679323937"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679323940"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679323940"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Reflex.Class.html#Event"><span class="hs-identifier hs-type">Event</span></a><span> </span><a href="#local-6989586621679323937"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679323939"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679323938"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="Reflex.Class.html#Dynamic"><span class="hs-identifier hs-type">Dynamic</span></a><span> </span><a href="#local-6989586621679323937"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679323940"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-148"></a><a name="foldDynM"><a href="Reflex.Dynamic.html#foldDynM"><span class="hs-identifier">foldDynM</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Reflex.Class.html#accumM"><span class="hs-identifier hs-var">accumM</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">flip</span><span>
</span><a name="line-149"></a><span>
</span><a name="line-150"></a><span class="hs-comment">-- | Create a 'Dynamic' using the provided initial value and change it each time</span><span>
</span><a name="line-151"></a><span class="hs-comment">-- the provided 'Event' occurs, using a function to combine the old value with</span><span>
</span><a name="line-152"></a><span class="hs-comment">-- the 'Event''s value.  If the function returns 'Nothing', the value is not</span><span>
</span><a name="line-153"></a><span class="hs-comment">-- changed; this is distinct from returning 'Just' the old value, since the</span><span>
</span><a name="line-154"></a><span class="hs-comment">-- 'Dynamic''s 'updated' 'Event' will fire in the 'Just' case, and will not fire</span><span>
</span><a name="line-155"></a><span class="hs-comment">-- in the 'Nothing' case.</span><span>
</span><a name="line-156"></a><span class="hs-identifier">foldDynMaybe</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Reflex.Class.html#Reflex"><span class="hs-identifier hs-type">Reflex</span></a><span> </span><a href="#local-6989586621679323933"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">,</span><span> </span><a href="Reflex.Class.html#MonadHold"><span class="hs-identifier hs-type">MonadHold</span></a><span> </span><a href="#local-6989586621679323933"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679323934"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">MonadFix</span><span> </span><a href="#local-6989586621679323934"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679323935"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679323936"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679323936"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679323936"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Reflex.Class.html#Event"><span class="hs-identifier hs-type">Event</span></a><span> </span><a href="#local-6989586621679323933"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679323935"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679323934"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="Reflex.Class.html#Dynamic"><span class="hs-identifier hs-type">Dynamic</span></a><span> </span><a href="#local-6989586621679323933"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679323936"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-157"></a><a name="foldDynMaybe"><a href="Reflex.Dynamic.html#foldDynMaybe"><span class="hs-identifier">foldDynMaybe</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Reflex.Class.html#accumMaybe"><span class="hs-identifier hs-var">accumMaybe</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">flip</span><span>
</span><a name="line-158"></a><span>
</span><a name="line-159"></a><span class="hs-comment">-- | Like 'foldDynMaybe', but the combining function is a 'PushM' action, so it</span><span>
</span><a name="line-160"></a><span class="hs-comment">-- can 'sample' existing 'Behaviors' and 'hold' new ones.</span><span>
</span><a name="line-161"></a><span class="hs-identifier">foldDynMaybeM</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Reflex.Class.html#Reflex"><span class="hs-identifier hs-type">Reflex</span></a><span> </span><a href="#local-6989586621679323929"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">,</span><span> </span><a href="Reflex.Class.html#MonadHold"><span class="hs-identifier hs-type">MonadHold</span></a><span> </span><a href="#local-6989586621679323929"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679323930"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">MonadFix</span><span> </span><a href="#local-6989586621679323930"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679323931"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679323932"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Reflex.Class.html#PushM"><span class="hs-identifier hs-type">PushM</span></a><span> </span><a href="#local-6989586621679323929"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679323932"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679323932"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Reflex.Class.html#Event"><span class="hs-identifier hs-type">Event</span></a><span> </span><a href="#local-6989586621679323929"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679323931"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679323930"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="Reflex.Class.html#Dynamic"><span class="hs-identifier hs-type">Dynamic</span></a><span> </span><a href="#local-6989586621679323929"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679323932"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-162"></a><a name="foldDynMaybeM"><a href="Reflex.Dynamic.html#foldDynMaybeM"><span class="hs-identifier">foldDynMaybeM</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Reflex.Class.html#accumMaybeM"><span class="hs-identifier hs-var">accumMaybeM</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">flip</span><span>
</span><a name="line-163"></a><span>
</span><a name="line-164"></a><span class="hs-comment">-- | Create a new 'Dynamic' that counts the occurences of the 'Event'.</span><span>
</span><a name="line-165"></a><span class="hs-identifier">count</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Reflex.Class.html#Reflex"><span class="hs-identifier hs-type">Reflex</span></a><span> </span><a href="#local-6989586621679323925"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">,</span><span> </span><a href="Reflex.Class.html#MonadHold"><span class="hs-identifier hs-type">MonadHold</span></a><span> </span><a href="#local-6989586621679323925"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679323926"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">MonadFix</span><span> </span><a href="#local-6989586621679323926"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679323927"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Reflex.Class.html#Event"><span class="hs-identifier hs-type">Event</span></a><span> </span><a href="#local-6989586621679323925"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679323928"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679323926"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="Reflex.Class.html#Dynamic"><span class="hs-identifier hs-type">Dynamic</span></a><span> </span><a href="#local-6989586621679323925"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679323927"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-166"></a><a name="count"><a href="Reflex.Dynamic.html#count"><span class="hs-identifier">count</span></a></a><span> </span><a name="local-6989586621679323976"><a href="#local-6989586621679323976"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Reflex.Class.html#holdDyn"><span class="hs-identifier hs-var">holdDyn</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-operator hs-var">=&lt;&lt;</span><span> </span><a href="Reflex.Class.html#zipListWithEvent"><span class="hs-identifier hs-var">zipListWithEvent</span></a><span> </span><span class="hs-identifier hs-var">const</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">iterate</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679323976"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-167"></a><span>
</span><a name="line-168"></a><span class="hs-comment">-- | Create a new 'Dynamic' using the initial value that flips its</span><span>
</span><a name="line-169"></a><span class="hs-comment">-- value every time the 'Event' occurs.</span><span>
</span><a name="line-170"></a><span class="hs-identifier">toggle</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Reflex.Class.html#Reflex"><span class="hs-identifier hs-type">Reflex</span></a><span> </span><a href="#local-6989586621679323922"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">,</span><span> </span><a href="Reflex.Class.html#MonadHold"><span class="hs-identifier hs-type">MonadHold</span></a><span> </span><a href="#local-6989586621679323922"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679323923"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">MonadFix</span><span> </span><a href="#local-6989586621679323923"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Reflex.Class.html#Event"><span class="hs-identifier hs-type">Event</span></a><span> </span><a href="#local-6989586621679323922"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679323924"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679323923"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="Reflex.Class.html#Dynamic"><span class="hs-identifier hs-type">Dynamic</span></a><span> </span><a href="#local-6989586621679323922"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span>
</span><a name="line-171"></a><a name="toggle"><a href="Reflex.Dynamic.html#toggle"><span class="hs-identifier">toggle</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Reflex.Dynamic.html#foldDyn"><span class="hs-identifier hs-var">foldDyn</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">const</span><span> </span><span class="hs-identifier hs-var">not</span><span class="hs-special">)</span><span>
</span><a name="line-172"></a><span>
</span><a name="line-173"></a><span class="hs-comment">-- | Switches to the new 'Event' whenever it receives one.  Switching occurs</span><span>
</span><a name="line-174"></a><span class="hs-comment">-- *before* the inner 'Event' fires - so if the 'Dynamic' changes and both the</span><span>
</span><a name="line-175"></a><span class="hs-comment">-- old and new inner Events fire simultaneously, the output will fire with the</span><span>
</span><a name="line-176"></a><span class="hs-comment">-- value of the *new* 'Event'.</span><span>
</span><a name="line-177"></a><span class="hs-identifier">switchPromptlyDyn</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679323920"><a href="#local-6989586621679323920"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679323921"><a href="#local-6989586621679323921"><span class="hs-identifier">a</span></a></a><span class="hs-operator">.</span><span> </span><a href="Reflex.Class.html#Reflex"><span class="hs-identifier hs-type">Reflex</span></a><span> </span><a href="#local-6989586621679323920"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Reflex.Class.html#Dynamic"><span class="hs-identifier hs-type">Dynamic</span></a><span> </span><a href="#local-6989586621679323920"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-special">(</span><a href="Reflex.Class.html#Event"><span class="hs-identifier hs-type">Event</span></a><span> </span><a href="#local-6989586621679323920"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679323921"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Reflex.Class.html#Event"><span class="hs-identifier hs-type">Event</span></a><span> </span><a href="#local-6989586621679323920"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679323921"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-178"></a><a name="switchPromptlyDyn"><a href="Reflex.Dynamic.html#switchPromptlyDyn"><span class="hs-identifier">switchPromptlyDyn</span></a></a><span> </span><a name="local-6989586621679323977"><a href="#local-6989586621679323977"><span class="hs-identifier">de</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-179"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679323978"><a href="#local-6989586621679323978"><span class="hs-identifier">eLag</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Reflex.Class.html#switch"><span class="hs-identifier hs-var">switch</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Reflex.Class.html#current"><span class="hs-identifier hs-var">current</span></a><span> </span><a href="#local-6989586621679323977"><span class="hs-identifier hs-var">de</span></a><span>
</span><a name="line-180"></a><span>      </span><a name="local-6989586621679323979"><a href="#local-6989586621679323979"><span class="hs-identifier">eCoincidences</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Reflex.Class.html#coincidence"><span class="hs-identifier hs-var">coincidence</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Reflex.Class.html#updated"><span class="hs-identifier hs-var">updated</span></a><span> </span><a href="#local-6989586621679323977"><span class="hs-identifier hs-var">de</span></a><span>
</span><a name="line-181"></a><span>  </span><span class="hs-keyword">in</span><span> </span><a href="Reflex.Class.html#leftmost"><span class="hs-identifier hs-var">leftmost</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679323979"><span class="hs-identifier hs-var">eCoincidences</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679323978"><span class="hs-identifier hs-var">eLag</span></a><span class="hs-special">]</span><span>
</span><a name="line-182"></a><span>
</span><a name="line-183"></a><span class="hs-comment">-- | Split a 'Dynamic' pair into a pair of 'Dynamic's</span><span>
</span><a name="line-184"></a><span class="hs-identifier">splitDynPure</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Reflex.Class.html#Reflex"><span class="hs-identifier hs-type">Reflex</span></a><span> </span><a href="#local-6989586621679323917"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Reflex.Class.html#Dynamic"><span class="hs-identifier hs-type">Dynamic</span></a><span> </span><a href="#local-6989586621679323917"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679323918"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679323919"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Reflex.Class.html#Dynamic"><span class="hs-identifier hs-type">Dynamic</span></a><span> </span><a href="#local-6989586621679323917"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679323918"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Reflex.Class.html#Dynamic"><span class="hs-identifier hs-type">Dynamic</span></a><span> </span><a href="#local-6989586621679323917"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679323919"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-185"></a><a name="splitDynPure"><a href="Reflex.Dynamic.html#splitDynPure"><span class="hs-identifier">splitDynPure</span></a></a><span> </span><a name="local-6989586621679323980"><a href="#local-6989586621679323980"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><a href="#local-6989586621679323980"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><a href="#local-6989586621679323980"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span>
</span><a name="line-186"></a><span>
</span><a name="line-187"></a><span class="hs-comment">-- | Convert a 'Map' with 'Dynamic' elements into a 'Dynamic' of a 'Map' with</span><span>
</span><a name="line-188"></a><span class="hs-comment">-- non-'Dynamic' elements.</span><span>
</span><a name="line-189"></a><span class="hs-identifier">distributeMapOverDynPure</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Reflex.Class.html#Reflex"><span class="hs-identifier hs-type">Reflex</span></a><span> </span><a href="#local-6989586621679323914"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679323915"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Map</span><span> </span><a href="#local-6989586621679323915"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-special">(</span><a href="Reflex.Class.html#Dynamic"><span class="hs-identifier hs-type">Dynamic</span></a><span> </span><a href="#local-6989586621679323914"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679323916"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Reflex.Class.html#Dynamic"><span class="hs-identifier hs-type">Dynamic</span></a><span> </span><a href="#local-6989586621679323914"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Map</span><span> </span><a href="#local-6989586621679323915"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679323916"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span>
</span><a name="line-190"></a><a name="distributeMapOverDynPure"><a href="Reflex.Dynamic.html#distributeMapOverDynPure"><span class="hs-identifier">distributeMapOverDynPure</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><a href="Data.Functor.Misc.html#dmapToMap"><span class="hs-identifier hs-var">dmapToMap</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Reflex.Class.html#distributeDMapOverDynPure"><span class="hs-identifier hs-var">distributeDMapOverDynPure</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.Functor.Misc.html#mapWithFunctorToDMap"><span class="hs-identifier hs-var">mapWithFunctorToDMap</span></a><span>
</span><a name="line-191"></a><span>
</span><a name="line-192"></a><span class="hs-comment">-- | Convert a list with 'Dynamic' elements into a 'Dynamic' of a list with</span><span>
</span><a name="line-193"></a><span class="hs-comment">-- non-'Dynamic' elements, preserving the order of the elements.</span><span>
</span><a name="line-194"></a><span class="hs-identifier">distributeListOverDynPure</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Reflex.Class.html#Reflex"><span class="hs-identifier hs-type">Reflex</span></a><span> </span><a href="#local-6989586621679323912"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="Reflex.Class.html#Dynamic"><span class="hs-identifier hs-type">Dynamic</span></a><span> </span><a href="#local-6989586621679323912"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679323913"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Reflex.Class.html#Dynamic"><span class="hs-identifier hs-type">Dynamic</span></a><span> </span><a href="#local-6989586621679323912"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679323913"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">]</span><span>
</span><a name="line-195"></a><a name="distributeListOverDynPure"><a href="Reflex.Dynamic.html#distributeListOverDynPure"><span class="hs-identifier">distributeListOverDynPure</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-196"></a><span>  </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-6989586621679323982"><span class="hs-identifier hs-var">fromDSum</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">DMap</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">toAscList</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span>
</span><a name="line-197"></a><span>  </span><a href="Reflex.Class.html#distributeDMapOverDynPure"><span class="hs-identifier hs-var">distributeDMapOverDynPure</span></a><span> </span><span class="hs-operator hs-var">.</span><span>
</span><a name="line-198"></a><span>  </span><span class="hs-identifier hs-var">DMap</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">fromDistinctAscList</span><span> </span><span class="hs-operator hs-var">.</span><span>
</span><a name="line-199"></a><span>  </span><span class="hs-identifier hs-var">zipWith</span><span> </span><a href="#local-6989586621679323981"><span class="hs-identifier hs-var">toDSum</span></a><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-glyph">..</span><span class="hs-special">]</span><span>
</span><a name="line-200"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-201"></a><span>    </span><span class="hs-identifier">toDSum</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Reflex.Class.html#Dynamic"><span class="hs-identifier hs-type">Dynamic</span></a><span> </span><a href="#local-6989586621679323983"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679323984"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DSum</span><span> </span><span class="hs-special">(</span><a href="Data.Functor.Misc.html#Const2"><span class="hs-identifier hs-type">Const2</span></a><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><a href="#local-6989586621679323984"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Reflex.Class.html#Dynamic"><span class="hs-identifier hs-type">Dynamic</span></a><span> </span><a href="#local-6989586621679323983"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-202"></a><span>    </span><a name="local-6989586621679323981"><a href="#local-6989586621679323981"><span class="hs-identifier">toDSum</span></a></a><span> </span><a name="local-6989586621679323986"><a href="#local-6989586621679323986"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679323987"><a href="#local-6989586621679323987"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Functor.Misc.html#Const2"><span class="hs-identifier hs-var">Const2</span></a><span> </span><a href="#local-6989586621679323986"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-operator hs-var">:=&gt;</span><span> </span><a href="#local-6989586621679323987"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-203"></a><span>    </span><span class="hs-identifier">fromDSum</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">DSum</span><span> </span><span class="hs-special">(</span><a href="Data.Functor.Misc.html#Const2"><span class="hs-identifier hs-type">Const2</span></a><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><a href="#local-6989586621679323985"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-type">Identity</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679323985"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-204"></a><span>    </span><a name="local-6989586621679323982"><a href="#local-6989586621679323982"><span class="hs-identifier">fromDSum</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Functor.Misc.html#Const2"><span class="hs-identifier hs-var">Const2</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-operator hs-var">:=&gt;</span><span> </span><span class="hs-identifier hs-var">Identity</span><span> </span><a name="local-6989586621679323988"><a href="#local-6989586621679323988"><span class="hs-identifier">v</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679323988"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-205"></a><span>
</span><a name="line-206"></a><span class="hs-comment">--TODO: Generalize this to functors other than Maps</span><span>
</span><a name="line-207"></a><span class="hs-comment">-- | Combine a 'Dynamic' of a 'Map' of 'Dynamic's into a 'Dynamic'</span><span>
</span><a name="line-208"></a><span class="hs-comment">-- with the current values of the 'Dynamic's in a map.</span><span>
</span><a name="line-209"></a><span class="hs-identifier">joinDynThroughMap</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679323909"><a href="#local-6989586621679323909"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679323910"><a href="#local-6989586621679323910"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679323911"><a href="#local-6989586621679323911"><span class="hs-identifier">a</span></a></a><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><a href="Reflex.Class.html#Reflex"><span class="hs-identifier hs-type">Reflex</span></a><span> </span><a href="#local-6989586621679323909"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679323910"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Reflex.Class.html#Dynamic"><span class="hs-identifier hs-type">Dynamic</span></a><span> </span><a href="#local-6989586621679323909"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Map</span><span> </span><a href="#local-6989586621679323910"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-special">(</span><a href="Reflex.Class.html#Dynamic"><span class="hs-identifier hs-type">Dynamic</span></a><span> </span><a href="#local-6989586621679323909"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679323911"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Reflex.Class.html#Dynamic"><span class="hs-identifier hs-type">Dynamic</span></a><span> </span><a href="#local-6989586621679323909"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Map</span><span> </span><a href="#local-6989586621679323910"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679323911"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-210"></a><a name="joinDynThroughMap"><a href="Reflex.Dynamic.html#joinDynThroughMap"><span class="hs-identifier">joinDynThroughMap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Reflex.Dynamic.html#joinDyn"><span class="hs-identifier hs-var">joinDyn</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><a href="Reflex.Dynamic.html#distributeMapOverDynPure"><span class="hs-identifier hs-var">distributeMapOverDynPure</span></a><span>
</span><a name="line-211"></a><span>
</span><a name="line-212"></a><span class="hs-comment">-- | Print the value of the 'Dynamic' when it is first read and on each</span><span>
</span><a name="line-213"></a><span class="hs-comment">-- subsequent change that is observed (as traceEvent), prefixed with the</span><span>
</span><a name="line-214"></a><span class="hs-comment">-- provided string. This should /only/ be used for debugging.</span><span>
</span><a name="line-215"></a><span class="hs-comment">--</span><span>
</span><a name="line-216"></a><span class="hs-comment">-- Note: Just like Debug.Trace.trace, the value will only be shown if something</span><span>
</span><a name="line-217"></a><span class="hs-comment">-- else in the system is depending on it.</span><span>
</span><a name="line-218"></a><span class="hs-identifier">traceDyn</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Reflex.Class.html#Reflex"><span class="hs-identifier hs-type">Reflex</span></a><span> </span><a href="#local-6989586621679323907"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679323908"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Reflex.Class.html#Dynamic"><span class="hs-identifier hs-type">Dynamic</span></a><span> </span><a href="#local-6989586621679323907"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679323908"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Reflex.Class.html#Dynamic"><span class="hs-identifier hs-type">Dynamic</span></a><span> </span><a href="#local-6989586621679323907"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679323908"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-219"></a><a name="traceDyn"><a href="Reflex.Dynamic.html#traceDyn"><span class="hs-identifier">traceDyn</span></a></a><span> </span><a name="local-6989586621679323989"><a href="#local-6989586621679323989"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Reflex.Dynamic.html#traceDynWith"><span class="hs-identifier hs-var">traceDynWith</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679323990"><a href="#local-6989586621679323990"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679323989"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot;: &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679323990"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-220"></a><span>
</span><a name="line-221"></a><span class="hs-comment">-- | Print the result of applying the provided function to the value</span><span>
</span><a name="line-222"></a><span class="hs-comment">-- of the 'Dynamic' when it is first read and on each subsequent change</span><span>
</span><a name="line-223"></a><span class="hs-comment">-- that is observed (as traceEvent). This should /only/ be used for</span><span>
</span><a name="line-224"></a><span class="hs-comment">-- debugging.</span><span>
</span><a name="line-225"></a><span class="hs-comment">--</span><span>
</span><a name="line-226"></a><span class="hs-comment">-- Note: Just like Debug.Trace.trace, the value will only be shown if something</span><span>
</span><a name="line-227"></a><span class="hs-comment">-- else in the system is depending on it.</span><span>
</span><a name="line-228"></a><span class="hs-identifier">traceDynWith</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Reflex.Class.html#Reflex"><span class="hs-identifier hs-type">Reflex</span></a><span> </span><a href="#local-6989586621679323905"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679323906"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Reflex.Class.html#Dynamic"><span class="hs-identifier hs-type">Dynamic</span></a><span> </span><a href="#local-6989586621679323905"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679323906"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Reflex.Class.html#Dynamic"><span class="hs-identifier hs-type">Dynamic</span></a><span> </span><a href="#local-6989586621679323905"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679323906"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-229"></a><a name="traceDynWith"><a href="Reflex.Dynamic.html#traceDynWith"><span class="hs-identifier">traceDynWith</span></a></a><span> </span><a name="local-6989586621679323991"><a href="#local-6989586621679323991"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679323992"><a href="#local-6989586621679323992"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-230"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679323993"><a href="#local-6989586621679323993"><span class="hs-identifier">e'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Reflex.Class.html#traceEventWith"><span class="hs-identifier hs-var">traceEventWith</span></a><span> </span><a href="#local-6989586621679323991"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Reflex.Class.html#updated"><span class="hs-identifier hs-var">updated</span></a><span> </span><a href="#local-6989586621679323992"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-231"></a><span>      </span><a name="local-6989586621679323994"><a href="#local-6989586621679323994"><span class="hs-identifier">getV0</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-232"></a><span>        </span><a name="local-6989586621679323995"><a href="#local-6989586621679323995"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Reflex.Class.html#sample"><span class="hs-identifier hs-var">sample</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Reflex.Class.html#current"><span class="hs-identifier hs-var">current</span></a><span> </span><a href="#local-6989586621679323992"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-233"></a><span>        </span><span class="hs-identifier hs-var">trace</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679323991"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679323995"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679323995"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-234"></a><span>  </span><span class="hs-keyword">in</span><span> </span><a href="Reflex.Class.html#unsafeBuildDynamic"><span class="hs-identifier hs-var">unsafeBuildDynamic</span></a><span> </span><a href="#local-6989586621679323994"><span class="hs-identifier hs-var">getV0</span></a><span> </span><a href="#local-6989586621679323993"><span class="hs-identifier hs-var">e'</span></a><span>
</span><a name="line-235"></a><span>
</span><a name="line-236"></a><span class="hs-comment">-- | Replace the value of the 'Event' with the current value of the 'Dynamic'</span><span>
</span><a name="line-237"></a><span class="hs-comment">-- each time the 'Event' occurs.</span><span>
</span><a name="line-238"></a><span class="hs-comment">--</span><span>
</span><a name="line-239"></a><span class="hs-comment">-- Note: `tagPromptlyDyn d e` differs from `tag (current d) e` in the case that `e` is firing</span><span>
</span><a name="line-240"></a><span class="hs-comment">-- at the same time that `d` is changing.  With `tagPromptlyDyn d e`, the *new* value of `d`</span><span>
</span><a name="line-241"></a><span class="hs-comment">-- will replace the value of `e`, whereas with `tag (current d) e`, the *old* value</span><span>
</span><a name="line-242"></a><span class="hs-comment">-- will be used, since the 'Behavior' won't be updated until the end of the frame.</span><span>
</span><a name="line-243"></a><span class="hs-comment">-- Additionally, this means that the output 'Event' may not be used to directly change</span><span>
</span><a name="line-244"></a><span class="hs-comment">-- the input 'Dynamic', because that would mean its value depends on itself.  When creating</span><span>
</span><a name="line-245"></a><span class="hs-comment">-- cyclic data flows, generally `tag (current d) e` is preferred.</span><span>
</span><a name="line-246"></a><span class="hs-identifier">tagPromptlyDyn</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Reflex.Class.html#Reflex"><span class="hs-identifier hs-type">Reflex</span></a><span> </span><a href="#local-6989586621679323902"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Reflex.Class.html#Dynamic"><span class="hs-identifier hs-type">Dynamic</span></a><span> </span><a href="#local-6989586621679323902"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679323903"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Reflex.Class.html#Event"><span class="hs-identifier hs-type">Event</span></a><span> </span><a href="#local-6989586621679323902"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679323904"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Reflex.Class.html#Event"><span class="hs-identifier hs-type">Event</span></a><span> </span><a href="#local-6989586621679323902"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679323903"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-247"></a><a name="tagPromptlyDyn"><a href="Reflex.Dynamic.html#tagPromptlyDyn"><span class="hs-identifier">tagPromptlyDyn</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Reflex.Dynamic.html#attachPromptlyDynWith"><span class="hs-identifier hs-var">attachPromptlyDynWith</span></a><span> </span><span class="hs-identifier hs-var">const</span><span>
</span><a name="line-248"></a><span>
</span><a name="line-249"></a><span class="hs-comment">-- | Attach the current value of the 'Dynamic' to the value of the</span><span>
</span><a name="line-250"></a><span class="hs-comment">-- 'Event' each time it occurs.</span><span>
</span><a name="line-251"></a><span class="hs-comment">--</span><span>
</span><a name="line-252"></a><span class="hs-comment">-- Note: `attachPromptlyDyn d` is not the same as `attach (current d)`.  See 'tagPromptlyDyn' for details.</span><span>
</span><a name="line-253"></a><span class="hs-identifier">attachPromptlyDyn</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Reflex.Class.html#Reflex"><span class="hs-identifier hs-type">Reflex</span></a><span> </span><a href="#local-6989586621679323899"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Reflex.Class.html#Dynamic"><span class="hs-identifier hs-type">Dynamic</span></a><span> </span><a href="#local-6989586621679323899"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679323900"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Reflex.Class.html#Event"><span class="hs-identifier hs-type">Event</span></a><span> </span><a href="#local-6989586621679323899"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679323901"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Reflex.Class.html#Event"><span class="hs-identifier hs-type">Event</span></a><span> </span><a href="#local-6989586621679323899"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679323900"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679323901"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-254"></a><a name="attachPromptlyDyn"><a href="Reflex.Dynamic.html#attachPromptlyDyn"><span class="hs-identifier">attachPromptlyDyn</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Reflex.Dynamic.html#attachPromptlyDynWith"><span class="hs-identifier hs-var">attachPromptlyDynWith</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span>
</span><a name="line-255"></a><span>
</span><a name="line-256"></a><span class="hs-comment">-- | Combine the current value of the 'Dynamic' with the value of the</span><span>
</span><a name="line-257"></a><span class="hs-comment">-- 'Event' each time it occurs.</span><span>
</span><a name="line-258"></a><span class="hs-comment">--</span><span>
</span><a name="line-259"></a><span class="hs-comment">-- Note: `attachPromptlyDynWith f d` is not the same as `attachWith f (current d)`.  See 'tagPromptlyDyn' for details.</span><span>
</span><a name="line-260"></a><span class="hs-identifier">attachPromptlyDynWith</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Reflex.Class.html#Reflex"><span class="hs-identifier hs-type">Reflex</span></a><span> </span><a href="#local-6989586621679323895"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679323896"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679323897"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679323898"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Reflex.Class.html#Dynamic"><span class="hs-identifier hs-type">Dynamic</span></a><span> </span><a href="#local-6989586621679323895"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679323896"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Reflex.Class.html#Event"><span class="hs-identifier hs-type">Event</span></a><span> </span><a href="#local-6989586621679323895"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679323897"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Reflex.Class.html#Event"><span class="hs-identifier hs-type">Event</span></a><span> </span><a href="#local-6989586621679323895"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679323898"><span class="hs-identifier hs-type">c</span></a><span>
</span><a name="line-261"></a><a name="attachPromptlyDynWith"><a href="Reflex.Dynamic.html#attachPromptlyDynWith"><span class="hs-identifier">attachPromptlyDynWith</span></a></a><span> </span><a name="local-6989586621679323996"><a href="#local-6989586621679323996"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Reflex.Dynamic.html#attachPromptlyDynWithMaybe"><span class="hs-identifier hs-var">attachPromptlyDynWithMaybe</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679323997"><a href="#local-6989586621679323997"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679323998"><a href="#local-6989586621679323998"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679323996"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679323997"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679323998"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-262"></a><span>
</span><a name="line-263"></a><span class="hs-comment">-- | Create a new 'Event' by combining the value at each occurence with the</span><span>
</span><a name="line-264"></a><span class="hs-comment">-- current value of the 'Dynamic' value and possibly filtering if the combining</span><span>
</span><a name="line-265"></a><span class="hs-comment">-- function returns 'Nothing'.</span><span>
</span><a name="line-266"></a><span class="hs-comment">--</span><span>
</span><a name="line-267"></a><span class="hs-comment">-- Note: `attachPromptlyDynWithMaybe f d` is not the same as `attachWithMaybe f</span><span>
</span><a name="line-268"></a><span class="hs-comment">-- (current d)`.  See 'tagPromptlyDyn' for details.</span><span>
</span><a name="line-269"></a><span class="hs-identifier">attachPromptlyDynWithMaybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Reflex.Class.html#Reflex"><span class="hs-identifier hs-type">Reflex</span></a><span> </span><a href="#local-6989586621679323891"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679323892"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679323893"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679323894"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Reflex.Class.html#Dynamic"><span class="hs-identifier hs-type">Dynamic</span></a><span> </span><a href="#local-6989586621679323891"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679323892"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Reflex.Class.html#Event"><span class="hs-identifier hs-type">Event</span></a><span> </span><a href="#local-6989586621679323891"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679323893"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Reflex.Class.html#Event"><span class="hs-identifier hs-type">Event</span></a><span> </span><a href="#local-6989586621679323891"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679323894"><span class="hs-identifier hs-type">c</span></a><span>
</span><a name="line-270"></a><a name="attachPromptlyDynWithMaybe"><a href="Reflex.Dynamic.html#attachPromptlyDynWithMaybe"><span class="hs-identifier">attachPromptlyDynWithMaybe</span></a></a><span> </span><a name="local-6989586621679323999"><a href="#local-6989586621679323999"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679324000"><a href="#local-6989586621679324000"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679324001"><a href="#local-6989586621679324001"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-271"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679324002"><a href="#local-6989586621679324002"><span class="hs-identifier">e'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Reflex.Class.html#attach"><span class="hs-identifier hs-var">attach</span></a><span> </span><span class="hs-special">(</span><a href="Reflex.Class.html#current"><span class="hs-identifier hs-var">current</span></a><span> </span><a href="#local-6989586621679324000"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679324001"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-272"></a><span>  </span><span class="hs-keyword">in</span><span> </span><a href="Reflex.Class.html#fforMaybe"><span class="hs-identifier hs-var">fforMaybe</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">align</span><span> </span><a href="#local-6989586621679324002"><span class="hs-identifier hs-var">e'</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Reflex.Class.html#updated"><span class="hs-identifier hs-var">updated</span></a><span> </span><a href="#local-6989586621679324000"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-keyword">case</span><span>
</span><a name="line-273"></a><span>       </span><span class="hs-identifier hs-var">This</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679324003"><a href="#local-6989586621679324003"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679324004"><a href="#local-6989586621679324004"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679323999"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679324003"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679324004"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-comment">-- Only the tagging event is firing, so use that</span><span>
</span><a name="line-274"></a><span>       </span><span class="hs-identifier hs-var">These</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679324005"><a href="#local-6989586621679324005"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679324006"><a href="#local-6989586621679324006"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679323999"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679324006"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679324005"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-comment">-- Both events are firing, so use the newer value</span><span>
</span><a name="line-275"></a><span>       </span><span class="hs-identifier hs-var">That</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-comment">-- The tagging event isn't firing, so don't fire</span><span>
</span><a name="line-276"></a><span>
</span><a name="line-277"></a><span class="hs-comment">-- | Factor a @Dynamic t (Maybe a)@ into a @Dynamic t (Maybe (Dynamic t a))@,</span><span>
</span><a name="line-278"></a><span class="hs-comment">-- such that the outer 'Dynamic' is updated only when the 'Maybe''s constructor</span><span>
</span><a name="line-279"></a><span class="hs-comment">-- chages from 'Nothing' to 'Just' or vice-versa.  Whenever the constructor</span><span>
</span><a name="line-280"></a><span class="hs-comment">-- becomes 'Just', an inner 'Dynamic' will be provided, whose value will track</span><span>
</span><a name="line-281"></a><span class="hs-comment">-- the 'a' inside the 'Just'; when the constructor becomes 'Nothing', the</span><span>
</span><a name="line-282"></a><span class="hs-comment">-- existing inner 'Dynamic' will become constant, and will not change when the</span><span>
</span><a name="line-283"></a><span class="hs-comment">-- outer constructor changes back to 'Nothing'.</span><span>
</span><a name="line-284"></a><span class="hs-identifier">maybeDyn</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679323888"><a href="#local-6989586621679323888"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679323889"><a href="#local-6989586621679323889"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679323890"><a href="#local-6989586621679323890"><span class="hs-identifier">m</span></a></a><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><a href="Reflex.Class.html#Reflex"><span class="hs-identifier hs-type">Reflex</span></a><span> </span><a href="#local-6989586621679323888"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">MonadFix</span><span> </span><a href="#local-6989586621679323890"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><a href="Reflex.Class.html#MonadHold"><span class="hs-identifier hs-type">MonadHold</span></a><span> </span><a href="#local-6989586621679323888"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679323890"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Reflex.Class.html#Dynamic"><span class="hs-identifier hs-type">Dynamic</span></a><span> </span><a href="#local-6989586621679323888"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679323889"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679323890"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="Reflex.Class.html#Dynamic"><span class="hs-identifier hs-type">Dynamic</span></a><span> </span><a href="#local-6989586621679323888"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="Reflex.Class.html#Dynamic"><span class="hs-identifier hs-type">Dynamic</span></a><span> </span><a href="#local-6989586621679323888"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679323889"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-285"></a><a name="maybeDyn"><a href="Reflex.Dynamic.html#maybeDyn"><span class="hs-identifier">maybeDyn</span></a></a><span> </span><a name="local-6989586621679324007"><a href="#local-6989586621679324007"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-286"></a><span>  </span><a name="local-6989586621679324008"><a href="#local-6989586621679324008"><span class="hs-identifier">ma</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Reflex.Class.html#sample"><span class="hs-identifier hs-var">sample</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Reflex.Class.html#current"><span class="hs-identifier hs-var">current</span></a><span> </span><a href="#local-6989586621679324007"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-287"></a><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">inner</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679324010"><a href="#local-6989586621679324010"><span class="hs-identifier">m'</span></a></a><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MonadFix</span><span> </span><a href="#local-6989586621679324010"><span class="hs-identifier hs-type">m'</span></a><span class="hs-special">,</span><span> </span><a href="Reflex.Class.html#MonadHold"><span class="hs-identifier hs-type">MonadHold</span></a><span> </span><a href="#local-6989586621679323888"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679324010"><span class="hs-identifier hs-type">m'</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679323889"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679324010"><span class="hs-identifier hs-type">m'</span></a><span> </span><span class="hs-special">(</span><a href="Reflex.Class.html#Dynamic"><span class="hs-identifier hs-type">Dynamic</span></a><span> </span><a href="#local-6989586621679323888"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679323889"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-288"></a><span>      </span><a name="local-6989586621679324009"><a href="#local-6989586621679324009"><span class="hs-identifier">inner</span></a></a><span> </span><a name="local-6989586621679324011"><a href="#local-6989586621679324011"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Reflex.Class.html#holdDyn"><span class="hs-identifier hs-var">holdDyn</span></a><span> </span><a href="#local-6989586621679324011"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Reflex.FunctorMaybe.html#fmapMaybe"><span class="hs-identifier hs-var">fmapMaybe</span></a><span> </span><span class="hs-identifier hs-var">id</span><span> </span><span class="hs-operator hs-var">=&lt;&lt;</span><span> </span><a href="Reflex.Class.html#takeWhileE"><span class="hs-identifier hs-var">takeWhileE</span></a><span> </span><span class="hs-identifier hs-var">isJust</span><span> </span><span class="hs-special">(</span><a href="Reflex.Class.html#updated"><span class="hs-identifier hs-var">updated</span></a><span> </span><a href="#local-6989586621679324007"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span>
</span><a name="line-289"></a><span>  </span><a name="local-6989586621679324012"><a href="#local-6989586621679324012"><span class="hs-identifier">mInner0</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="Reflex.Class.html#Dynamic"><span class="hs-identifier hs-type">Dynamic</span></a><span> </span><a href="#local-6989586621679323888"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679323889"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="#local-6989586621679324009"><span class="hs-identifier hs-var">inner</span></a><span> </span><a href="#local-6989586621679324008"><span class="hs-identifier hs-var">ma</span></a><span>
</span><a name="line-290"></a><span>  </span><span class="hs-identifier">rec</span><span> </span><a name="local-6989586621679324013"><a href="#local-6989586621679324013"><span class="hs-identifier">result</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Reflex.Class.html#holdDyn"><span class="hs-identifier hs-var">holdDyn</span></a><span> </span><a href="#local-6989586621679324012"><span class="hs-identifier hs-var">mInner0</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">flip</span><span> </span><a href="Reflex.Class.html#push"><span class="hs-identifier hs-var">push</span></a><span> </span><span class="hs-special">(</span><a href="Reflex.Class.html#updated"><span class="hs-identifier hs-var">updated</span></a><span> </span><a href="#local-6989586621679324007"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679324014"><a href="#local-6989586621679324014"><span class="hs-identifier">new</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-291"></a><span>        </span><a name="local-6989586621679324015"><a href="#local-6989586621679324015"><span class="hs-identifier">old</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Reflex.Class.html#sample"><span class="hs-identifier hs-var">sample</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Reflex.Class.html#current"><span class="hs-identifier hs-var">current</span></a><span> </span><a href="#local-6989586621679324007"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-292"></a><span>        </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">isJust</span><span> </span><a href="#local-6989586621679324015"><span class="hs-identifier hs-var">old</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">isJust</span><span> </span><a href="#local-6989586621679324014"><span class="hs-identifier hs-var">new</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="#local-6989586621679324009"><span class="hs-identifier hs-var">inner</span></a><span> </span><a href="#local-6989586621679324014"><span class="hs-identifier hs-var">new</span></a><span>
</span><a name="line-293"></a><span>  </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679324013"><span class="hs-identifier hs-var">result</span></a><span>
</span><a name="line-294"></a><span>
</span><a name="line-295"></a><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><a name="line-296"></a><span class="hs-comment">-- Demux</span><span>
</span><a name="line-297"></a><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><a name="line-298"></a><span>
</span><a name="line-299"></a><span class="hs-comment">-- | Represents a time changing value together with an 'EventSelector' that can</span><span>
</span><a name="line-300"></a><span class="hs-comment">-- efficiently detect when the underlying 'Dynamic' has a particular value.</span><span>
</span><a name="line-301"></a><span class="hs-comment">-- This is useful for representing data like the current selection of a long</span><span>
</span><a name="line-302"></a><span class="hs-comment">-- list.</span><span>
</span><a name="line-303"></a><span class="hs-comment">--</span><span>
</span><a name="line-304"></a><span class="hs-comment">-- Semantically,</span><span>
</span><a name="line-305"></a><span class="hs-comment">--</span><span>
</span><a name="line-306"></a><span class="hs-comment">-- &gt; demuxed (demux d) k === fmap (== k) d</span><span>
</span><a name="line-307"></a><span class="hs-comment">--</span><span>
</span><a name="line-308"></a><span class="hs-comment">-- However, the when getDemuxed is used multiple times, the complexity is only</span><span>
</span><a name="line-309"></a><span class="hs-comment">-- /O(log(n))/, rather than /O(n)/ for fmap.</span><span>
</span><a name="line-310"></a><span class="hs-keyword">data</span><span> </span><a name="Demux"><a href="Reflex.Dynamic.html#Demux"><span class="hs-identifier">Demux</span></a></a><span> </span><a name="local-6989586621679323801"><a href="#local-6989586621679323801"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679323802"><a href="#local-6989586621679323802"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Demux"><a href="Reflex.Dynamic.html#Demux"><span class="hs-identifier">Demux</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="demuxValue"><a href="Reflex.Dynamic.html#demuxValue"><span class="hs-identifier">demuxValue</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Reflex.Class.html#Behavior"><span class="hs-identifier hs-type">Behavior</span></a><span> </span><a href="#local-6989586621679323801"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679323802"><span class="hs-identifier hs-type">k</span></a><span>
</span><a name="line-311"></a><span>                       </span><span class="hs-special">,</span><span> </span><a name="demuxSelector"><a href="Reflex.Dynamic.html#demuxSelector"><span class="hs-identifier">demuxSelector</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Reflex.Class.html#EventSelector"><span class="hs-identifier hs-type">EventSelector</span></a><span> </span><a href="#local-6989586621679323801"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-special">(</span><a href="Data.Functor.Misc.html#Const2"><span class="hs-identifier hs-type">Const2</span></a><span> </span><a href="#local-6989586621679323802"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span>
</span><a name="line-312"></a><span>                       </span><span class="hs-special">}</span><span>
</span><a name="line-313"></a><span>
</span><a name="line-314"></a><span class="hs-comment">-- | Demultiplex an input value to a 'Demux' with many outputs.  At any given</span><span>
</span><a name="line-315"></a><span class="hs-comment">-- time, whichever output is indicated by the given 'Dynamic' will be 'True'.</span><span>
</span><a name="line-316"></a><span class="hs-identifier">demux</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Reflex.Class.html#Reflex"><span class="hs-identifier hs-type">Reflex</span></a><span> </span><a href="#local-6989586621679323886"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679323887"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Reflex.Class.html#Dynamic"><span class="hs-identifier hs-type">Dynamic</span></a><span> </span><a href="#local-6989586621679323886"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679323887"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Reflex.Dynamic.html#Demux"><span class="hs-identifier hs-type">Demux</span></a><span> </span><a href="#local-6989586621679323886"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679323887"><span class="hs-identifier hs-type">k</span></a><span>
</span><a name="line-317"></a><a name="demux"><a href="Reflex.Dynamic.html#demux"><span class="hs-identifier">demux</span></a></a><span> </span><a name="local-6989586621679324016"><a href="#local-6989586621679324016"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Reflex.Dynamic.html#Demux"><span class="hs-identifier hs-var">Demux</span></a><span> </span><span class="hs-special">(</span><a href="Reflex.Class.html#current"><span class="hs-identifier hs-var">current</span></a><span> </span><a href="#local-6989586621679324016"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span>
</span><a name="line-318"></a><span>                </span><span class="hs-special">(</span><a href="Reflex.Class.html#fan"><span class="hs-identifier hs-var">fan</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Reflex.Class.html#attachWith"><span class="hs-identifier hs-var">attachWith</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679324017"><a href="#local-6989586621679324017"><span class="hs-identifier">k0</span></a></a><span> </span><a name="local-6989586621679324018"><a href="#local-6989586621679324018"><span class="hs-identifier">k1</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679324017"><span class="hs-identifier hs-var">k0</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679324018"><span class="hs-identifier hs-var">k1</span></a><span>
</span><a name="line-319"></a><span>                                                </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">DMap</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">empty</span><span>
</span><a name="line-320"></a><span>                                                </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">DMap</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">fromList</span><span> </span><span class="hs-special">[</span><a href="Data.Functor.Misc.html#Const2"><span class="hs-identifier hs-var">Const2</span></a><span> </span><a href="#local-6989586621679324017"><span class="hs-identifier hs-var">k0</span></a><span> </span><span class="hs-operator hs-var">:=&gt;</span><span> </span><span class="hs-identifier hs-var">Identity</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">,</span><span>
</span><a name="line-321"></a><span>                                                                    </span><a href="Data.Functor.Misc.html#Const2"><span class="hs-identifier hs-var">Const2</span></a><span> </span><a href="#local-6989586621679324018"><span class="hs-identifier hs-var">k1</span></a><span> </span><span class="hs-operator hs-var">:=&gt;</span><span> </span><span class="hs-identifier hs-var">Identity</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-322"></a><span>                                  </span><span class="hs-special">(</span><a href="Reflex.Class.html#current"><span class="hs-identifier hs-var">current</span></a><span> </span><a href="#local-6989586621679324016"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Reflex.Class.html#updated"><span class="hs-identifier hs-var">updated</span></a><span> </span><a href="#local-6989586621679324016"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-323"></a><span>
</span><a name="line-324"></a><span class="hs-comment">-- | Select a particular output of the 'Demux'; this is equivalent to (but much</span><span>
</span><a name="line-325"></a><span class="hs-comment">-- faster than) mapping over the original 'Dynamic' and checking whether it is</span><span>
</span><a name="line-326"></a><span class="hs-comment">-- equal to the given key.</span><span>
</span><a name="line-327"></a><span class="hs-identifier">demuxed</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Reflex.Class.html#Reflex"><span class="hs-identifier hs-type">Reflex</span></a><span> </span><a href="#local-6989586621679323884"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679323885"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Reflex.Dynamic.html#Demux"><span class="hs-identifier hs-type">Demux</span></a><span> </span><a href="#local-6989586621679323884"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679323885"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679323885"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Reflex.Class.html#Dynamic"><span class="hs-identifier hs-type">Dynamic</span></a><span> </span><a href="#local-6989586621679323884"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-328"></a><a name="demuxed"><a href="Reflex.Dynamic.html#demuxed"><span class="hs-identifier">demuxed</span></a></a><span> </span><a name="local-6989586621679324019"><a href="#local-6989586621679324019"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679324020"><a href="#local-6989586621679324020"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-329"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679324021"><a href="#local-6989586621679324021"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">select</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">demuxSelector</span><span> </span><a href="#local-6989586621679324019"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Functor.Misc.html#Const2"><span class="hs-identifier hs-var">Const2</span></a><span> </span><a href="#local-6989586621679324020"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span>
</span><a name="line-330"></a><span>  </span><span class="hs-keyword">in</span><span> </span><a href="Reflex.Class.html#unsafeBuildDynamic"><span class="hs-identifier hs-var">unsafeBuildDynamic</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">==</span><a href="#local-6989586621679324020"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Reflex.Class.html#sample"><span class="hs-identifier hs-var">sample</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">demuxValue</span><span> </span><a href="#local-6989586621679324019"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679324021"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-331"></a><span>
</span><a name="line-332"></a><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><a name="line-333"></a><span class="hs-comment">-- collectDyn</span><span>
</span><a name="line-334"></a><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><a name="line-335"></a><span>
</span><a name="line-336"></a><span class="hs-comment">--TODO: This whole section is badly in need of cleanup</span><span>
</span><a name="line-337"></a><span>
</span><a name="line-338"></a><span class="hs-comment">-- | A heterogeneous list whose type and length are fixed statically.  This is</span><span>
</span><a name="line-339"></a><span class="hs-comment">-- reproduced from the 'HList' package due to integration issues, and because</span><span>
</span><a name="line-340"></a><span class="hs-comment">-- very little other functionality from that library is needed.</span><span>
</span><a name="line-341"></a><span class="hs-keyword">data</span><span> </span><a name="HList"><a href="Reflex.Dynamic.html#HList"><span class="hs-identifier">HList</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679323798"><a href="#local-6989586621679323798"><span class="hs-identifier">l</span></a></a><span class="hs-glyph">::</span><span class="hs-special">[</span><span class="hs-operator hs-type">*</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-342"></a><span>  </span><a name="HNil"><a href="Reflex.Dynamic.html#HNil"><span class="hs-identifier">HNil</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="Reflex.Dynamic.html#HList"><span class="hs-identifier hs-type">HList</span></a><span> </span><span class="hs-char">'[]
  HCons :: e -&gt; HList l -&gt; HList (e ': l)

infixr 2 `HCons`

type family HRevApp (l1 :: [k]) (l2 :: [k]) :: [k]
type instance HRevApp '[] l = l
type instance HRevApp (e ': l) l' = HRevApp l (e ': l')

hRevApp :: HList l1 -&gt; HList l2 -&gt; HList (HRevApp l1 l2)
hRevApp HNil l = l
hRevApp (HCons x l) l' = hRevApp l (HCons x l')

hReverse :: HList l -&gt; HList (HRevApp l '[])
hReverse l = hRevApp l HNil

hBuild :: (HBuild' '[] r) =&gt; r
hBuild =  hBuild' HNil

class HBuild' l r where
    hBuild' :: HList l -&gt; r

instance (l' ~ HRevApp l '[])
      =&gt; HBuild' l (HList l') where
  hBuild' = hReverse

instance HBuild' (a ': l) r
      =&gt; HBuild' l (a-&gt;r) where
  hBuild' l x = hBuild' (HCons x l)

-- | Like 'HList', but with a functor wrapping each element.
data FHList f l where
  FHNil :: FHList f '[]
  FHCons :: f e -&gt; FHList f l -&gt; FHList f (e ': l)

instance GEq (HListPtr l) where
#ifdef EXPERIMENTAL_DEPENDENT_SUM_INSTANCES
  geqToEq _ = id
  geqUnify HHeadPtr HHeadPtr _ same = same
  geqUnify (HTailPtr a) (HTailPtr b) different same = geqUnify a b different same
  geqUnify _ _ different _ = different
#endif
  HHeadPtr `geq` HHeadPtr = Just Refl
  HHeadPtr `geq` HTailPtr _ = Nothing
  HTailPtr _ `geq` HHeadPtr = Nothing
  HTailPtr a `geq` HTailPtr b = a `geq` b

instance GCompare (HListPtr l) where -- Warning: This ordering can't change, dmapTo*HList will break
#ifdef EXPERIMENTAL_DEPENDENT_SUM_INSTANCES
  gcompareToOrd _ = id
#endif
  HHeadPtr `gcompare` HHeadPtr = GEQ
  HHeadPtr `gcompare` HTailPtr _ = GLT
  HTailPtr _ `gcompare` HHeadPtr = GGT
  HTailPtr a `gcompare` HTailPtr b = a `gcompare` b

-- | A typed index into a typed heterogeneous list.
data HListPtr l a where
  HHeadPtr :: HListPtr (h ': t) h
  HTailPtr :: HListPtr t a -&gt; HListPtr (h ': t) a

deriving instance Eq (HListPtr l a)
deriving instance Ord (HListPtr l a)

fhlistToDMap :: forall (f :: * -&gt; *) l. FHList f l -&gt; DMap (HListPtr l) f
fhlistToDMap = DMap.fromList . go
  where go :: forall l'. FHList f l' -&gt; [DSum (HListPtr l') f]
        go = \case
          FHNil -&gt; []
          FHCons h t -&gt; (HHeadPtr :=&gt; h) : map (\(p :=&gt; v) -&gt; HTailPtr p :=&gt; v) (go t)

-- | This class allows 'HList's and 'FHlist's to be built from regular lists;
-- they must be contiguous and sorted.
class RebuildSortedHList l where
  rebuildSortedFHList :: [DSum (HListPtr l) f] -&gt; FHList f l
  rebuildSortedHList :: [DSum (HListPtr l) Identity] -&gt; HList l

instance RebuildSortedHList '[] where
  rebuildSortedFHList l = case l of
    [] -&gt; FHNil
    _ : _ -&gt; error &quot;rebuildSortedFHList{'[]}: empty list expected&quot;
  rebuildSortedHList l = case l of
    [] -&gt; HNil
    _ : _ -&gt; error &quot;rebuildSortedHList{'[]}: empty list expected&quot;

instance RebuildSortedHList t =&gt; RebuildSortedHList (h ': t) where
  rebuildSortedFHList l = case l of
    ((HHeadPtr :=&gt; h) : t) -&gt; FHCons h . rebuildSortedFHList . map (\(HTailPtr p :=&gt; v) -&gt; p :=&gt; v) $ t
    _ -&gt; error &quot;rebuildSortedFHList{h':t}: non-empty list with HHeadPtr expected&quot;
  rebuildSortedHList l = case l of
    ((HHeadPtr :=&gt; Identity h) : t) -&gt; HCons h . rebuildSortedHList . map (\(HTailPtr p :=&gt; v) -&gt; p :=&gt; v) $ t
    _ -&gt; error &quot;rebuildSortedHList{h':t}: non-empty list with HHeadPtr expected&quot;

dmapToHList :: forall l. RebuildSortedHList l =&gt; DMap (HListPtr l) Identity -&gt; HList l
dmapToHList = rebuildSortedHList . DMap.toList

-- | Collect a hetereogeneous list whose elements are all 'Dynamic's into a
-- single 'Dynamic' whose value represents the current values of all of the
-- input 'Dynamic's.
distributeFHListOverDynPure :: (Reflex t, RebuildSortedHList l) =&gt; FHList (Dynamic t) l -&gt; Dynamic t (HList l)
distributeFHListOverDynPure l = fmap dmapToHList $ distributeDMapOverDynPure $ fhlistToDMap l

-- | Indicates that all elements in a type-level list are applications of the
-- same functor.
class AllAreFunctors (f :: a -&gt; *) (l :: [a]) where
  type FunctorList f l :: [*]
  toFHList :: HList (FunctorList f l) -&gt; FHList f l
  fromFHList :: FHList f l -&gt; HList (FunctorList f l)

instance AllAreFunctors f '[] where
  type FunctorList f '[] = '[]
  toFHList l = case l of
    HNil -&gt; FHNil
#if !defined(__GLASGOW_HASKELL__) || __GLASGOW_HASKELL__ &lt; 800
    _ -&gt; error &quot;toFHList: impossible&quot; -- Otherwise, GHC complains of a non-exhaustive pattern match; see https://ghc.haskell.org/trac/ghc/ticket/4139
#endif
  fromFHList FHNil = HNil

instance AllAreFunctors f t =&gt; AllAreFunctors f (h ': t) where
  type FunctorList f (h ': t) = f h ': FunctorList f t
  toFHList l = case l of
    a `HCons` b -&gt; a `FHCons` toFHList b
#if !defined(__GLASGOW_HASKELL__) || __GLASGOW_HASKELL__ &lt; 800
    _ -&gt; error &quot;toFHList: impossible&quot; -- Otherwise, GHC complains of a non-exhaustive pattern match; see https://ghc.haskell.org/trac/ghc/ticket/4139
#endif
  fromFHList (a `FHCons` b) = a `HCons` fromFHList b

-- | Convert a datastructure whose constituent parts are all 'Dynamic's into a
-- single 'Dynamic' whose value represents all the current values of the input's
-- consitutent 'Dynamic's.
collectDynPure :: ( RebuildSortedHList (HListElems b)
                  , IsHList a, IsHList b
                  , AllAreFunctors (Dynamic t) (HListElems b)
                  , Reflex t
                  , HListElems a ~ FunctorList (Dynamic t) (HListElems b)
                  ) =&gt; a -&gt; Dynamic t b
collectDynPure ds = fmap fromHList $ distributeFHListOverDynPure $ toFHList $ toHList ds

-- | Poor man's 'Generic's for product types only.
class IsHList a where
  type HListElems a :: [*]
  toHList :: a -&gt; HList (HListElems a)
  fromHList :: HList (HListElems a) -&gt; a

instance IsHList (a, b) where
  type HListElems (a, b) = [a, b]
  toHList (a, b) = hBuild a b
  fromHList l = case l of
    a `HCons` b `HCons` HNil -&gt; (a, b)
#if !defined(__GLASGOW_HASKELL__) || __GLASGOW_HASKELL__ &lt; 800
    _ -&gt; error &quot;fromHList: impossible&quot; -- Otherwise, GHC complains of a non-exhaustive pattern match; see https://ghc.haskell.org/trac/ghc/ticket/4139
#endif

instance IsHList (a, b, c, d) where
  type HListElems (a, b, c, d) = [a, b, c, d]
  toHList (a, b, c, d) = hBuild a b c d
  fromHList l = case l of
    a `HCons` b `HCons` c `HCons` d `HCons` HNil -&gt; (a, b, c, d)
#if !defined(__GLASGOW_HASKELL__) || __GLASGOW_HASKELL__ &lt; 800
    _ -&gt; error &quot;fromHList: impossible&quot; -- Otherwise, GHC complains of a non-exhaustive pattern match; see https://ghc.haskell.org/trac/ghc/ticket/4139
#endif

instance IsHList (a, b, c, d, e, f) where
  type HListElems (a, b, c, d, e, f) = [a, b, c, d, e, f]
  toHList (a, b, c, d, e, f) = hBuild a b c d e f
  fromHList l = case l of
    a `HCons` b `HCons` c `HCons` d `HCons` e `HCons` f `HCons` HNil -&gt; (a, b, c, d, e, f)
#if !defined(__GLASGOW_HASKELL__) || __GLASGOW_HASKELL__ &lt; 800
    _ -&gt; error &quot;fromHList: impossible&quot; -- Otherwise, GHC complains of a non-exhaustive pattern match; see https://ghc.haskell.org/trac/ghc/ticket/4139
#endif

--------------------------------------------------------------------------------
-- Deprecated functions
--------------------------------------------------------------------------------

-- | Map a function over a 'Dynamic'.
{-# DEPRECATED mapDyn &quot;Use 'return . fmap f' instead of 'mapDyn f'; consider eliminating monadic style&quot; #-}
mapDyn :: (Reflex t, Monad m) =&gt; (a -&gt; b) -&gt; Dynamic t a -&gt; m (Dynamic t b)
mapDyn f = return . fmap f

-- | Map a sampling function over a 'Dynamic'.  The sampling function will use the input 'Dynamic''s 'current' 'Behavior' until the first time its 'updated' 'Event' fires, at which point it will be invoked only once each time the 'Event' fires.
{-# DEPRECATED mapDynM &quot;Consider using the Monad instance for Dynamic instead.&quot; #-}
mapDynM :: forall t m a b. (Reflex t, MonadHold t m) =&gt; (forall m'. MonadSample t m' =&gt; a -&gt; m' b) -&gt; Dynamic t a -&gt; m (Dynamic t b)
mapDynM f d = do
  let e' = push (fmap Just . f :: a -&gt; PushM t (Maybe b)) $ updated d
      eb' = fmap constant e'
      v0 = pull $ f =&lt;&lt; sample (current d)
  bb' :: Behavior t (Behavior t b) &lt;- hold v0 eb'
  let b' = pull $ sample =&lt;&lt; sample bb'
  return $ unsafeDynamic b' e'

-- | Flipped version of 'mapDyn'.
{-# DEPRECATED forDyn &quot;Use 'return . ffor a' instead of 'forDyn a'; consider eliminating monadic style&quot; #-}
forDyn :: (Reflex t, Monad m) =&gt; Dynamic t a -&gt; (a -&gt; b) -&gt; m (Dynamic t b)
forDyn a = return . ffor a

-- | Flipped version of 'mapDynM'
{-# DEPRECATED forDynM &quot;Consider using the Monad instance for Dynamic instead.&quot; #-}
forDynM :: forall t m a b. (Reflex t, MonadHold t m) =&gt; Dynamic t a -&gt; (forall m'. MonadSample t m' =&gt; a -&gt; m' b) -&gt; m (Dynamic t b)
forDynM d f = mapDynM f d

-- | Split the 'Dynamic' into two 'Dynamic's, each taking the respective value
-- of the tuple.
{-# DEPRECATED splitDyn &quot;Use 'return . splitDynPure' instead; consider eliminating monadic style&quot; #-}
splitDyn :: (Reflex t, Monad m) =&gt; Dynamic t (a, b) -&gt; m (Dynamic t a, Dynamic t b)
splitDyn = return . splitDynPure

-- | Merge the 'Dynamic' values using their 'Monoid' instance.
{-# DEPRECATED mconcatDyn &quot;Use 'return . mconcat' instead; consider eliminating monadic style&quot; #-}
mconcatDyn :: forall t m a. (Reflex t, Monad m, Monoid a) =&gt; [Dynamic t a] -&gt; m (Dynamic t a)
mconcatDyn = return . mconcat

-- | This function no longer needs to be monadic; see 'distributeMapOverDynPure'.
{-# DEPRECATED distributeDMapOverDyn &quot;Use 'return . distributeDMapOverDynPure' instead; consider eliminating monadic style&quot; #-}
distributeDMapOverDyn :: (Reflex t, Monad m, GCompare k) =&gt; DMap k (Dynamic t) -&gt; m (Dynamic t (DMap k Identity))
distributeDMapOverDyn = return . distributeDMapOverDynPure

-- | Merge two 'Dynamic's into a new one using the provided function. The new
-- 'Dynamic' changes its value each time one of the original 'Dynamic's changes
-- its value.
{-# DEPRECATED combineDyn &quot;Use 'return (zipDynWith f a b)' instead of 'combineDyn f a b'; consider eliminating monadic style&quot; #-}
combineDyn :: forall t m a b c. (Reflex t, Monad m) =&gt; (a -&gt; b -&gt; c) -&gt; Dynamic t a -&gt; Dynamic t b -&gt; m (Dynamic t c)
combineDyn f a b = return $ zipDynWith f a b

-- | A psuedo applicative version of ap for 'Dynamic'. Example useage:
--
-- &gt; do
-- &gt;    person &lt;- Person `mapDyn` dynFirstName
-- &gt;                     `apDyn` dynListName
-- &gt;                     `apDyn` dynAge
-- &gt;                     `apDyn` dynAddress
{-# DEPRECATED apDyn &quot;Use 'ffor m (&lt;*&gt; a)' instead of 'apDyn m a'; consider eliminating monadic style, since Dynamics are now Applicative and can be used with applicative style directly&quot; #-}
#ifdef USE_TEMPLATE_HASKELL
{-# ANN apDyn &quot;HLint: ignore Use fmap&quot; #-}
#endif
apDyn :: forall t m a b. (Reflex t, Monad m)
      =&gt; m (Dynamic t (a -&gt; b))
      -&gt; Dynamic t a
      -&gt; m (Dynamic t b)
apDyn m a = fmap (&lt;*&gt; a) m

--TODO: The pattern of using hold (sample b0) can be reused in various places as a safe way of building certain kinds of Dynamics; see if we can factor this out
-- | This function no longer needs to be monadic, so it has been replaced by
-- 'demuxed', which is pure.
{-# DEPRECATED getDemuxed &quot;Use 'return . demuxed d' instead of 'getDemuxed d'; consider eliminating monadic style&quot; #-}
getDemuxed :: (Reflex t, Monad m, Eq k) =&gt; Demux t k -&gt; k -&gt; m (Dynamic t Bool)
getDemuxed d = return . demuxed d

-- | This function no longer needs to be monadic, so it has been replaced by
-- 'distributeFHListOverDynPure', which is pure.
{-# DEPRECATED distributeFHListOverDyn &quot;Use 'return . distributeFHListOverDynPure' instead; consider eliminating monadic style&quot; #-}
distributeFHListOverDyn :: forall t m l. (Reflex t, Monad m, RebuildSortedHList l) =&gt; FHList (Dynamic t) l -&gt; m (Dynamic t (HList l))
distributeFHListOverDyn = return . distributeFHListOverDynPure

-- | This function no longer needs to be monadic, so it has been replaced by
-- 'collectDynPure', which is pure.
{-# DEPRECATED collectDyn &quot;Use 'return . collectDynPure' instead; consider eliminating monadic style&quot; #-}
collectDyn :: ( RebuildSortedHList (HListElems b)
              , IsHList a, IsHList b
              , AllAreFunctors (Dynamic t) (HListElems b)
              , Reflex t, Monad m
              , HListElems a ~ FunctorList (Dynamic t) (HListElems b)
              ) =&gt; a -&gt; m (Dynamic t b)
collectDyn = return . collectDynPure

-- | This function has been renamed to 'tagPromptlyDyn' to clarify its
-- semantics.
{-# DEPRECATED tagDyn &quot;Use 'tagPromptlyDyn' instead&quot; #-}
tagDyn :: Reflex t =&gt; Dynamic t a -&gt; Event t b -&gt; Event t a
tagDyn = tagPromptlyDyn

-- | This function has been renamed to 'attachPromptlyDyn' to clarify its
-- semantics.
{-# DEPRECATED attachDyn &quot;Use 'attachPromptlyDyn' instead&quot; #-}
attachDyn :: Reflex t =&gt; Dynamic t a -&gt; Event t b -&gt; Event t (a, b)
attachDyn = attachPromptlyDyn

-- | This function has been renamed to 'attachPromptlyDynWith' to clarify its
-- semantics.
{-# DEPRECATED attachDynWith &quot;Use 'attachPromptlyDynWith' instead&quot; #-}
attachDynWith :: Reflex t =&gt; (a -&gt; b -&gt; c) -&gt; Dynamic t a -&gt; Event t b -&gt; Event t c
attachDynWith = attachPromptlyDynWith

-- | This function has been renamed to 'attachPromptlyDynWithMaybe' to clarify
-- its semantics.
{-# DEPRECATED attachDynWithMaybe &quot;Use 'attachPromptlyDynWithMaybe' instead&quot; #-}
attachDynWithMaybe :: Reflex t =&gt; (a -&gt; b -&gt; Maybe c) -&gt; Dynamic t a -&gt; Event t b -&gt; Event t c
attachDynWithMaybe = attachPromptlyDynWithMaybe

-- | Combine an inner and outer 'Dynamic' such that the resulting 'Dynamic''s
-- current value will always be equal to the current value's current value, and
-- will change whenever either the inner or the outer (or both) values change.
{-# DEPRECATED joinDyn &quot;Use 'join' instead&quot; #-}
joinDyn :: Reflex t =&gt; Dynamic t (Dynamic t a) -&gt; Dynamic t a
joinDyn = join

-- | WARNING: This function is only pure if @a@'s 'Eq' instance tests
-- representational equality.  Use 'holdUniqDyn' instead, which is pure in all
-- circumstances.  Also, note that, unlike 'nub', this function does not prevent
-- all recurrences of a value, only consecutive recurrences.
{-# DEPRECATED nubDyn &quot;Use 'holdUniqDyn' instead; note that it returns a MonadHold action rather than a pure Dynamic&quot; #-}
nubDyn :: (Reflex t, Eq a) =&gt; Dynamic t a -&gt; Dynamic t a
nubDyn = uniqDyn

-- | WARNING: This function is only pure if @a@'s 'Eq' instance tests
-- representational equality.  Use 'holdUniqDyn' instead, which is pure in all
-- circumstances.
{-# DEPRECATED uniqDyn &quot;Use 'holdUniqDyn' instead; note that it returns a MonadHold action rather than a pure Dynamic&quot; #-}
uniqDyn :: (Reflex t, Eq a) =&gt; Dynamic t a -&gt; Dynamic t a
uniqDyn = uniqDynBy (==)

-- | WARNING: This function is impure.  Use 'holdUniqDynBy' instead.
{-# DEPRECATED uniqDynBy &quot;Use 'holdUniqDynBy' instead; note that it returns a MonadHold action rather than a pure Dynamic&quot; #-}
uniqDynBy :: Reflex t =&gt; (a -&gt; a -&gt; Bool) -&gt; Dynamic t a -&gt; Dynamic t a
uniqDynBy eq d =
  let e' = attachWithMaybe (\x x' -&gt; if x' `eq` x then Nothing else Just x') (current d) (updated d)
  in unsafeDynamic (current d) e'
</span></pre></body></html>